<!DOCTYPE html>
<html>
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>Messages | Bitcore &mdash; A pure and powerful JavaScript Bitcoin library.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="canonical" href="http://bitcore.io/guide/module/p2p/messages.html">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <link href="/css/animations.css" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Ubuntu:light,regular,bold&subset=Latin" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Ubuntu%20Mono:regular,bold&subset=Latin" rel="stylesheet" type="text/css">
  <link rel="alternative" href="/atom.xml" title="Bitcore" type="application/atom+xml">

  <meta property="og:image" content="/css/images/lava-ball-social.png" />
  <meta name="twitter:image" content="http://bitcore.io/css/images/lava-ball-social.png">

  <meta name="description" content="A superclass for the messages of the bitcoin network">
<meta property="og:type" content="website">
<meta property="og:title" content="Messages">
<meta property="og:url" content="http://bitcore.io/guide/module/p2p/messages.html">
<meta property="og:site_name" content="Bitcore">
<meta property="og:description" content="A superclass for the messages of the bitcoin network">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Messages">
<meta name="twitter:description" content="A superclass for the messages of the bitcoin network">
<meta name="twitter:site" content="@bitpay">

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24163874-2', 'bitcore.io');
  ga('send', 'pageview');
</script>

</head>


<body>
  <header id="header"  class="invert" >
  <div class="outer">
    <div class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Bitcore</a>
        <a id="main-nav-toggle"></a>
      </h1>
      <nav id="main-nav">
        <ul id="main-nav-list">
          
            
              <li class="main-nav-item">
                <a href="/api/" class="main-nav-link api">API</a>
              </li>
            
          
            
              <li class="main-nav-item">
                <a href="/guide/" class="main-nav-link docs">Docs</a>
              </li>
            
          
            
              <li class="main-nav-item">
                <a href="https://github.com/bitpay/bitcore" class="main-nav-link github">Github</a>
              </li>
            
          
            
              <li class="main-nav-item">
                <a href="http://labs.bitpay.com/" class="main-nav-link forum">Forum</a>
              </li>
            
          
            
              <li class="main-nav-item">
                <a href="http://bitcore.io/playground" class="main-nav-link playground">Playground</a>
              </li>
            
          
        </ul>
      </nav>
    </div>
  </div>
</header>

  <article class="page" itemscope itemtype="http://schema.org/Article">
  <header id="page-banner">
    <div class="outer">
      <div id="page-banner-inner" class="inner">
        
        <h1 id="page-title" class="docs" itemprop="name">Documentation</h1>
        
          
          <a href="https://github.com/bitpay/bitcore-p2p/blob/master/docs/messages.md" title="Improve this doc" id="page-edit-link"></a>
        
      </div>
    </div>
  </header>
  <div class="outer">
    <div id="mobile-menu-wrap"></div>
    <div class="page-content">
      <div class="toc-wrap">
        <strong class="toc-title">Contents</strong>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Messages"><span class="toc-number">1.</span> <span class="toc-text">Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#List_of_Messages"><span class="toc-number">1.1.</span> <span class="toc-text">List of Messages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Version"><span class="toc-number">1.1.1.</span> <span class="toc-text">Version</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VerAck"><span class="toc-number">1.1.2.</span> <span class="toc-text">VerAck</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Inventory"><span class="toc-number">1.1.3.</span> <span class="toc-text">Inventory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetData"><span class="toc-number">1.1.4.</span> <span class="toc-text">GetData</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NotFound"><span class="toc-number">1.1.5.</span> <span class="toc-text">NotFound</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ping"><span class="toc-number">1.1.6.</span> <span class="toc-text">Ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pong"><span class="toc-number">1.1.7.</span> <span class="toc-text">Pong</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Address_and_GetAddresses"><span class="toc-number">1.1.8.</span> <span class="toc-text">Address and GetAddresses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetHeaders_and_Headers"><span class="toc-number">1.1.9.</span> <span class="toc-text">GetHeaders and Headers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetBlocks_and_Block"><span class="toc-number">1.1.10.</span> <span class="toc-text">GetBlocks and Block</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transaction"><span class="toc-number">1.1.11.</span> <span class="toc-text">Transaction</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom_Messages"><span class="toc-number">1.2.</span> <span class="toc-text">Custom Messages</span></a></li></ol></li></ol>
      </div>
      <div class="page-entry" itemprop="articleBody">
        <h1 id="Messages">Messages</h1>
<p>The bitcoin protocol specifies a set of <a href="https://en.bitcoin.it/wiki/Protocol_specification" target="_blank" rel="external">messages</a> that can be sent from peer to peer. <code>bitcore-p2p</code> provides support for some of these messages.</p>
<p>To create a message, you can use any of the message constructors, here is a simple example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> messages = <span class="keyword">new</span> Messages();</div><div class="line"><span class="keyword">var</span> message = messages.Ping();</div></pre></td></tr></table></figure>

<p>There are also several convenient helpers for inventory based messages:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">message = messages.GetData.forTransaction(txHash);</div><div class="line">message = messages.GetData.forBlock(blockHash);</div><div class="line">message = messages.Inventory.forTransaction(txHash);</div></pre></td></tr></table></figure>

<p>As well as sending “tx” and “block” messages with Bitcore instances:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">message = messages.Block(block);</div><div class="line">message = messages.Transaction(transaction);</div></pre></td></tr></table></figure>

<p>Note: A list of further messages is available below.</p>
<p>For advanced usage, you can also customize which constructor is used for Block and Transaction messages by passing it as an argument to Messages, for example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> messages = <span class="keyword">new</span> Messages({Block: MyBlock, Transaction: MyTransaction});</div></pre></td></tr></table></figure>

<p>And additionally a custom network:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> messages = <span class="keyword">new</span> Messages({network: Networks.testnet});</div></pre></td></tr></table></figure>

<h2 id="List_of_Messages">List of Messages</h2>
<h3 id="Version">Version</h3>
<p>The version message (<code>ver</code>) is used on connection creation, to advertise the type of node. The remote node will respond with its version, and no communication is possible until both peers have exchanged their versions. By default, bitcore advertises itself as named <code>bitcore</code> with the current version of the <code>bitcore-p2p</code> package.</p>
<h3 id="VerAck">VerAck</h3>
<p>Finishes the connection handshake started by the <code>ver</code> message.</p>
<h3 id="Inventory">Inventory</h3>
<p>From the bitcoin protocol spec: “Allows a node to advertise its knowledge of one or more objects. It can be received unsolicited, or in reply to getblocks.”.</p>
<h3 id="GetData">GetData</h3>
<p>From the bitcoin protocol spec: <code>getdata</code> is used in response to <code>inv</code>, to retrieve the content of a specific object, and is usually sent after receiving an <code>inv</code> packet, after filtering known elements. It can be used to retrieve transactions, but only if they are in the memory pool or relay set - arbitrary access to transactions in the chain is not allowed to avoid having clients start to depend on nodes having full transaction indexes (which modern nodes do not).</p>
<p>GetData inherits from Inventory, as they both have the same structure.</p>
<h3 id="NotFound">NotFound</h3>
<p>notfound is a response to a getdata, sent if any requested data items could not be relayed, for example, because the requested transaction was not in the memory pool or relay set. Contains inventory information specifying which items were not found.</p>
<h3 id="Ping">Ping</h3>
<p>Sent to another peer mainly to check the connection is still alive.</p>
<h3 id="Pong">Pong</h3>
<p>Sent in response to a <code>ping</code> message.</p>
<h3 id="Address_and_GetAddresses">Address and GetAddresses</h3>
<p>Provides information on known nodes of the network. <code>GetAddresses</code> is used to query another peer for known addresses.</p>
<h3 id="GetHeaders_and_Headers">GetHeaders and Headers</h3>
<p><code>getheaders</code> allows a peer to query another about blockheaders. <code>headers</code> is sent in response to a <code>getheaders</code> message, containing information about block headers.</p>
<h3 id="GetBlocks_and_Block">GetBlocks and Block</h3>
<p>Same as <code>getheaders</code> and <code>headers</code>, but the response comes one block at the time.</p>
<h3 id="Transaction">Transaction</h3>
<p>Message that contains a transaction.</p>
<h2 id="Custom_Messages">Custom Messages</h2>
<p>It is possible to extend the default peer to peer messages and add custom ones. First you will need to create a message which resembles the default messages in <code>lib/messages/commands</code>.</p>
<p>Then to add the custom message:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">messages.add(<span class="string">'custom'</span>, <span class="string">'Custom'</span>, CustomMessage);</div><div class="line"></div><div class="line"><span class="keyword">var</span> customMessage = messages.Custom(<span class="string">'argument'</span>);</div></pre></td></tr></table></figure>


      </div>
      <footer id="page-footer">
        <time id="page-footer-updated" datetime="2015-08-19T18:21:29.873Z" itemprop="dateModified">Last updated: Aug 19 2015</time>
        <a href="index.html" id="page-footer-next" title="Get Started">Next</a>
      </footer>
      
    </div>
    <aside id="sidebar">

  

  
    <strong class="sidebar-title">Home</strong>
    
      <a href="/guide/index.html" class="sidebar-link">Get Started</a>
    
      <a href="/guide/contributing.html" class="sidebar-link">Contributing</a>
    
  
    <strong class="sidebar-title">Bitcore</strong>
    
      <a href="/guide/address.html" class="sidebar-link">Address</a>
    
      <a href="/guide/block.html" class="sidebar-link">Block</a>
    
      <a href="/guide/browser.html" class="sidebar-link">Browser</a>
    
      <a href="/guide/crypto.html" class="sidebar-link">Crypto</a>
    
      <a href="/guide/encoding.html" class="sidebar-link">Encoding</a>
    
      <a href="/guide/hierarchical.html" class="sidebar-link">HD Keys</a>
    
      <a href="/guide/networks.html" class="sidebar-link">Networks</a>
    
      <a href="/guide/privatekey.html" class="sidebar-link">Private Key</a>
    
      <a href="/guide/publickey.html" class="sidebar-link">Public Key</a>
    
      <a href="/guide/script.html" class="sidebar-link">Script</a>
    
      <a href="/guide/transaction.html" class="sidebar-link">Transaction</a>
    
      <a href="/guide/unit.html" class="sidebar-link">Unit</a>
    
      <a href="/guide/unspentoutput.html" class="sidebar-link">Unspent Output</a>
    
      <a href="/guide/uri.html" class="sidebar-link">URI</a>
    
  
    <strong class="sidebar-title">Payment Protocol</strong>
    
      <a href="/guide/module/payment-protocol/index.html" class="sidebar-link">Usage</a>
    
  
    <strong class="sidebar-title">Peer-to-Peer</strong>
    
      <a href="/guide/module/p2p/index.html" class="sidebar-link">Overview</a>
    
      <a href="/guide/module/p2p/messages.html" class="sidebar-link current">Messages</a>
    
      <a href="/guide/module/p2p/peer.html" class="sidebar-link">Peer</a>
    
      <a href="/guide/module/p2p/pool.html" class="sidebar-link">Pool</a>
    
  
    <strong class="sidebar-title">Message Signing and Verification</strong>
    
      <a href="/guide/module/message/index.html" class="sidebar-link">Overview</a>
    
  
    <strong class="sidebar-title">Mnemonic</strong>
    
      <a href="/guide/module/mnemonic/index.html" class="sidebar-link">Overview</a>
    
  
    <strong class="sidebar-title">ECIES</strong>
    
      <a href="/guide/module/ecies/index.html" class="sidebar-link">Overview</a>
    
  
    <strong class="sidebar-title">Channel</strong>
    
      <a href="/guide/module/channel/index.html" class="sidebar-link">Overview</a>
    
  
    <strong class="sidebar-title">Explorers</strong>
    
      <a href="/guide/module/explorers/index.html" class="sidebar-link">Overview</a>
    
  




</aside>
  </div>
</article>

  <footer id="footer">
  <div class="outer">
    <div class="inner">
      <div id="footer-copyright">
        <p>bitcore™ &copy; 2013-2015 BitPay, Inc. bitcore is released under the MIT license.</p>
      </div>
      <div id="footer-links">
        <a href="https://twitter.com/bitpay" id="footer-link-twitter" class="footer-link" target="_blank"><span>Twitter</span></a>
        <a href="https://github.com/bitpay/bitcore" id="footer-link-github" class="footer-link" target="_blank"><span>GitHub</span></a>
      </div>
    </div>
  </div>
</footer>

  
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="/js/retina.min.js" type="text/javascript"></script>

<script src="/js/script.js" type="text/javascript"></script>

<!-- Google+ -->
<script type="text/javascript" src="//apis.google.com/js/plusone.js"></script>
<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

</body>
</html>